Warning:  if --fp16 is not used, static_loss_scale will be ignored.
=> creating model '('resnet50', 'classic', 1000)'
Version: {'net': <class 'image_classification.resnet.ResNet'>, 'block': <class 'image_classification.resnet.Bottleneck'>, 'layers': [3, 4, 6, 3], 'widths': [64, 128, 256, 512], 'expansion': 4}
Config: {'conv': <class 'torch.nn.modules.conv.Conv2d'>, 'conv_init': 'fan_out', 'nonlinearity': 'relu', 'last_bn_0_init': False, 'activation': <function <lambda> at 0x7fd42ec62a60>}
Num classes: 1000
DLL 2020-12-11 03:39:50.265416 - PARAMETER data : /imagenet  data_backend : dali-cpu  arch : resnet50  model_config : classic  num_classes : 1000  workers : 5  epochs : 1  run_epochs : -1  batch_size : 256  optimizer_batch_size : -1  lr : 0.1  lr_schedule : step  warmup : 0  label_smoothing : 0.0  mixup : 0.0  momentum : 0.9  weight_decay : 0.0001  bn_weight_decay : False  nesterov : False  print_freq : 1  resume : None  pretrained_weights :   fp16 : False  static_loss_scale : 256.0  dynamic_loss_scale : False  prof : 100  amp : True  seed : None  gather_checkpoints : False  raport_file : benchmark.json  evaluate : False  training_only : True  save_checkpoints : True  checkpoint_filename : checkpoint.pth.tar  workspace : ./  memory_format : nchw  distributed : False  gpu : 0  world_size : 1 
 ! Weight decay NOT applied to BN parameters 
98
63
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : 256.0
RUNNING EPOCHS FROM 0 TO 1
DLL 2020-12-11 03:39:55.730754 - Epoch: 0 Iteration: 1  train.loss : 7.13170  train.total_ips : 47.02 img/s
DLL 2020-12-11 03:39:56.050668 - Epoch: 0 Iteration: 2  train.loss : 6.86805  train.total_ips : 800.39 img/s
DLL 2020-12-11 03:39:56.369229 - Epoch: 0 Iteration: 3  train.loss : 6.50823  train.total_ips : 803.84 img/s
DLL 2020-12-11 03:39:56.687891 - Epoch: 0 Iteration: 4  train.loss : 8.90401  train.total_ips : 803.66 img/s
DLL 2020-12-11 03:39:57.006432 - Epoch: 0 Iteration: 5  train.loss : 9.46824  train.total_ips : 803.89 img/s
DLL 2020-12-11 03:39:57.325114 - Epoch: 0 Iteration: 6  train.loss : 9.98869  train.total_ips : 803.53 img/s
DLL 2020-12-11 03:39:57.643365 - Epoch: 0 Iteration: 7  train.loss : 9.67365  train.total_ips : 804.68 img/s
DLL 2020-12-11 03:39:57.961552 - Epoch: 0 Iteration: 8  train.loss : 10.48281  train.total_ips : 804.82 img/s
DLL 2020-12-11 03:39:58.279731 - Epoch: 0 Iteration: 9  train.loss : 8.62422  train.total_ips : 804.79 img/s
DLL 2020-12-11 03:39:58.597605 - Epoch: 0 Iteration: 10  train.loss : 7.36342  train.total_ips : 805.59 img/s
DLL 2020-12-11 03:39:58.915729 - Epoch: 0 Iteration: 11  train.loss : 6.54493  train.total_ips : 805.00 img/s
DLL 2020-12-11 03:39:59.233681 - Epoch: 0 Iteration: 12  train.loss : 7.49810  train.total_ips : 805.45 img/s
DLL 2020-12-11 03:39:59.551804 - Epoch: 0 Iteration: 13  train.loss : 9.96102  train.total_ips : 804.95 img/s
DLL 2020-12-11 03:39:59.869480 - Epoch: 0 Iteration: 14  train.loss : 10.17683  train.total_ips : 806.12 img/s
DLL 2020-12-11 03:40:00.187294 - Epoch: 0 Iteration: 15  train.loss : 9.67116  train.total_ips : 805.74 img/s
DLL 2020-12-11 03:40:00.505141 - Epoch: 0 Iteration: 16  train.loss : 7.08797  train.total_ips : 805.70 img/s
DLL 2020-12-11 03:40:00.823150 - Epoch: 0 Iteration: 17  train.loss : 8.44771  train.total_ips : 805.27 img/s
DLL 2020-12-11 03:40:01.141151 - Epoch: 0 Iteration: 18  train.loss : 7.06430  train.total_ips : 805.30 img/s
DLL 2020-12-11 03:40:01.459026 - Epoch: 0 Iteration: 19  train.loss : 6.98209  train.total_ips : 805.66 img/s
DLL 2020-12-11 03:40:01.776707 - Epoch: 0 Iteration: 20  train.loss : 9.05337  train.total_ips : 806.12 img/s
DLL 2020-12-11 03:40:02.094559 - Epoch: 0 Iteration: 21  train.loss : 8.91624  train.total_ips : 805.64 img/s
DLL 2020-12-11 03:40:02.412276 - Epoch: 0 Iteration: 22  train.loss : 7.24366  train.total_ips : 805.99 img/s
DLL 2020-12-11 03:40:02.730006 - Epoch: 0 Iteration: 23  train.loss : 6.69178  train.total_ips : 805.96 img/s
DLL 2020-12-11 03:40:03.047543 - Epoch: 0 Iteration: 24  train.loss : 6.28948  train.total_ips : 806.46 img/s
DLL 2020-12-11 03:40:03.365105 - Epoch: 0 Iteration: 25  train.loss : 6.43800  train.total_ips : 806.40 img/s
DLL 2020-12-11 03:40:03.682778 - Epoch: 0 Iteration: 26  train.loss : 6.83772  train.total_ips : 806.15 img/s
DLL 2020-12-11 03:40:04.000691 - Epoch: 0 Iteration: 27  train.loss : 7.05428  train.total_ips : 805.50 img/s
DLL 2020-12-11 03:40:04.318191 - Epoch: 0 Iteration: 28  train.loss : 7.45003  train.total_ips : 806.53 img/s
DLL 2020-12-11 03:40:04.636210 - Epoch: 0 Iteration: 29  train.loss : 6.57349  train.total_ips : 805.21 img/s
DLL 2020-12-11 03:40:04.953801 - Epoch: 0 Iteration: 30  train.loss : 6.40995  train.total_ips : 806.32 img/s
DLL 2020-12-11 03:40:05.271662 - Epoch: 0 Iteration: 31  train.loss : 6.42035  train.total_ips : 805.69 img/s
DLL 2020-12-11 03:40:05.589583 - Epoch: 0 Iteration: 32  train.loss : 7.08969  train.total_ips : 805.47 img/s
DLL 2020-12-11 03:40:05.907189 - Epoch: 0 Iteration: 33  train.loss : 7.32726  train.total_ips : 806.28 img/s
DLL 2020-12-11 03:40:06.224889 - Epoch: 0 Iteration: 34  train.loss : 6.41297  train.total_ips : 806.01 img/s
DLL 2020-12-11 03:40:06.542349 - Epoch: 0 Iteration: 35  train.loss : 6.70244  train.total_ips : 806.59 img/s
DLL 2020-12-11 03:40:06.860124 - Epoch: 0 Iteration: 36  train.loss : 5.77591  train.total_ips : 805.85 img/s
DLL 2020-12-11 03:40:07.178121 - Epoch: 0 Iteration: 37  train.loss : 6.60291  train.total_ips : 805.25 img/s
DLL 2020-12-11 03:40:07.496175 - Epoch: 0 Iteration: 38  train.loss : 5.91960  train.total_ips : 805.51 img/s
DLL 2020-12-11 03:40:07.814912 - Epoch: 0 Iteration: 39  train.loss : 5.64409  train.total_ips : 803.77 img/s
DLL 2020-12-11 03:40:08.133473 - Epoch: 0 Iteration: 40  train.loss : 6.35373  train.total_ips : 803.70 img/s
DLL 2020-12-11 03:40:08.451054 - Epoch: 0 Iteration: 41  train.loss : 5.91513  train.total_ips : 806.34 img/s
DLL 2020-12-11 03:40:08.768821 - Epoch: 0 Iteration: 42  train.loss : 6.09632  train.total_ips : 805.87 img/s
DLL 2020-12-11 03:40:09.086253 - Epoch: 0 Iteration: 43  train.loss : 5.38393  train.total_ips : 806.72 img/s
DLL 2020-12-11 03:40:09.404105 - Epoch: 0 Iteration: 44  train.loss : 5.81307  train.total_ips : 805.60 img/s
DLL 2020-12-11 03:40:09.721677 - Epoch: 0 Iteration: 45  train.loss : 5.63954  train.total_ips : 806.33 img/s
DLL 2020-12-11 03:40:10.039564 - Epoch: 0 Iteration: 46  train.loss : 5.57899  train.total_ips : 805.61 img/s
DLL 2020-12-11 03:40:10.356958 - Epoch: 0 Iteration: 47  train.loss : 5.71469  train.total_ips : 806.85 img/s
DLL 2020-12-11 03:40:10.674674 - Epoch: 0 Iteration: 48  train.loss : 5.40710  train.total_ips : 806.04 img/s
DLL 2020-12-11 03:40:10.992161 - Epoch: 0 Iteration: 49  train.loss : 5.26030  train.total_ips : 806.63 img/s
DLL 2020-12-11 03:40:11.309791 - Epoch: 0 Iteration: 50  train.loss : 5.59709  train.total_ips : 806.21 img/s
DLL 2020-12-11 03:40:11.627441 - Epoch: 0 Iteration: 51  train.loss : 5.48418  train.total_ips : 806.20 img/s
DLL 2020-12-11 03:40:11.945366 - Epoch: 0 Iteration: 52  train.loss : 5.04052  train.total_ips : 805.47 img/s
DLL 2020-12-11 03:40:12.263049 - Epoch: 0 Iteration: 53  train.loss : 5.49003  train.total_ips : 806.07 img/s
DLL 2020-12-11 03:40:12.580435 - Epoch: 0 Iteration: 54  train.loss : 5.34638  train.total_ips : 806.84 img/s
DLL 2020-12-11 03:40:12.898365 - Epoch: 0 Iteration: 55  train.loss : 5.48135  train.total_ips : 805.46 img/s
DLL 2020-12-11 03:40:13.216246 - Epoch: 0 Iteration: 56  train.loss : 5.47118  train.total_ips : 805.57 img/s
DLL 2020-12-11 03:40:13.533856 - Epoch: 0 Iteration: 57  train.loss : 5.16171  train.total_ips : 806.22 img/s
DLL 2020-12-11 03:40:13.851761 - Epoch: 0 Iteration: 58  train.loss : 5.25846  train.total_ips : 805.55 img/s
DLL 2020-12-11 03:40:14.169315 - Epoch: 0 Iteration: 59  train.loss : 4.99086  train.total_ips : 806.36 img/s
DLL 2020-12-11 03:40:14.486963 - Epoch: 0 Iteration: 60  train.loss : 5.00004  train.total_ips : 806.15 img/s
DLL 2020-12-11 03:40:14.805194 - Epoch: 0 Iteration: 61  train.loss : 4.88794  train.total_ips : 804.97 img/s
DLL 2020-12-11 03:40:15.123586 - Epoch: 0 Iteration: 62  train.loss : 4.98219  train.total_ips : 804.26 img/s
DLL 2020-12-11 03:40:15.441170 - Epoch: 0 Iteration: 63  train.loss : 4.93237  train.total_ips : 806.33 img/s
DLL 2020-12-11 03:40:15.758551 - Epoch: 0 Iteration: 64  train.loss : 4.94270  train.total_ips : 806.87 img/s
DLL 2020-12-11 03:40:16.076006 - Epoch: 0 Iteration: 65  train.loss : 4.82137  train.total_ips : 806.62 img/s
DLL 2020-12-11 03:40:16.393562 - Epoch: 0 Iteration: 66  train.loss : 4.90723  train.total_ips : 806.38 img/s
DLL 2020-12-11 03:40:16.710992 - Epoch: 0 Iteration: 67  train.loss : 4.75107  train.total_ips : 806.70 img/s
DLL 2020-12-11 03:40:17.028535 - Epoch: 0 Iteration: 68  train.loss : 4.84274  train.total_ips : 806.46 img/s
DLL 2020-12-11 03:40:17.345927 - Epoch: 0 Iteration: 69  train.loss : 4.80955  train.total_ips : 806.79 img/s
DLL 2020-12-11 03:40:17.663689 - Epoch: 0 Iteration: 70  train.loss : 5.29309  train.total_ips : 806.21 img/s
DLL 2020-12-11 03:40:17.982193 - Epoch: 0 Iteration: 71  train.loss : 4.77499  train.total_ips : 804.11 img/s
DLL 2020-12-11 03:40:18.300262 - Epoch: 0 Iteration: 72  train.loss : 4.81934  train.total_ips : 805.00 img/s
DLL 2020-12-11 03:40:18.618024 - Epoch: 0 Iteration: 73  train.loss : 4.87717  train.total_ips : 805.85 img/s
DLL 2020-12-11 03:40:18.935571 - Epoch: 0 Iteration: 74  train.loss : 4.77259  train.total_ips : 806.43 img/s
DLL 2020-12-11 03:40:19.253329 - Epoch: 0 Iteration: 75  train.loss : 4.83975  train.total_ips : 805.85 img/s
DLL 2020-12-11 03:40:19.570666 - Epoch: 0 Iteration: 76  train.loss : 4.73646  train.total_ips : 806.93 img/s
DLL 2020-12-11 03:40:19.887902 - Epoch: 0 Iteration: 77  train.loss : 4.75493  train.total_ips : 807.25 img/s
DLL 2020-12-11 03:40:20.205643 - Epoch: 0 Iteration: 78  train.loss : 4.79995  train.total_ips : 805.91 img/s
DLL 2020-12-11 03:40:20.523423 - Epoch: 0 Iteration: 79  train.loss : 4.76158  train.total_ips : 805.89 img/s
DLL 2020-12-11 03:40:20.841606 - Epoch: 0 Iteration: 80  train.loss : 4.66918  train.total_ips : 804.77 img/s
DLL 2020-12-11 03:40:21.159605 - Epoch: 0 Iteration: 81  train.loss : 4.74504  train.total_ips : 806.27 img/s
DLL 2020-12-11 03:40:21.479144 - Epoch: 0 Iteration: 82  train.loss : 4.73018  train.total_ips : 801.00 img/s
DLL 2020-12-11 03:40:21.796681 - Epoch: 0 Iteration: 83  train.loss : 4.87981  train.total_ips : 806.42 img/s
DLL 2020-12-11 03:40:22.114307 - Epoch: 0 Iteration: 84  train.loss : 4.72584  train.total_ips : 806.18 img/s
DLL 2020-12-11 03:40:22.431810 - Epoch: 0 Iteration: 85  train.loss : 4.73028  train.total_ips : 806.50 img/s
DLL 2020-12-11 03:40:22.749422 - Epoch: 0 Iteration: 86  train.loss : 4.71445  train.total_ips : 806.21 img/s
DLL 2020-12-11 03:40:23.067181 - Epoch: 0 Iteration: 87  train.loss : 4.71125  train.total_ips : 805.84 img/s
DLL 2020-12-11 03:40:23.384539 - Epoch: 0 Iteration: 88  train.loss : 4.67425  train.total_ips : 806.91 img/s
DLL 2020-12-11 03:40:23.702126 - Epoch: 0 Iteration: 89  train.loss : 4.69444  train.total_ips : 806.25 img/s
DLL 2020-12-11 03:40:24.019426 - Epoch: 0 Iteration: 90  train.loss : 5.11558  train.total_ips : 806.99 img/s
DLL 2020-12-11 03:40:24.336761 - Epoch: 0 Iteration: 91  train.loss : 4.64462  train.total_ips : 806.90 img/s
DLL 2020-12-11 03:40:24.654202 - Epoch: 0 Iteration: 92  train.loss : 4.67035  train.total_ips : 806.67 img/s
DLL 2020-12-11 03:40:24.971983 - Epoch: 0 Iteration: 93  train.loss : 4.65216  train.total_ips : 805.86 img/s
DLL 2020-12-11 03:40:25.289495 - Epoch: 0 Iteration: 94  train.loss : 4.69909  train.total_ips : 806.54 img/s
DLL 2020-12-11 03:40:25.607026 - Epoch: 0 Iteration: 95  train.loss : 4.70290  train.total_ips : 806.41 img/s
DLL 2020-12-11 03:40:25.924685 - Epoch: 0 Iteration: 96  train.loss : 4.68317  train.total_ips : 806.09 img/s
DLL 2020-12-11 03:40:26.242330 - Epoch: 0 Iteration: 97  train.loss : 4.69520  train.total_ips : 806.56 img/s
DLL 2020-12-11 03:40:26.560668 - Epoch: 0 Iteration: 98  train.loss : 4.70332  train.total_ips : 804.39 img/s
DLL 2020-12-11 03:40:26.878196 - Epoch: 0 Iteration: 99  train.loss : 4.70173  train.total_ips : 806.38 img/s
DLL 2020-12-11 03:40:27.195642 - Epoch: 0  train.loss : 6.02337  train.total_ips : 798.15 img/s
DLL 2020-12-11 03:40:27.195767 - Epoch: 0  lr : 0.1  train.compute_ips : 801.31 img/s train.data_time : 0.00125 s train.compute_time : 0.36774 s
SAVING ./checkpoint.pth.tar
DLL 2020-12-11 03:40:27.670157 - Summary: train.loss : 6.02337  train.total_ips : 798.15 img/s
DLL 2020-12-11 03:40:27.670305 - Summary: lr : 0.1  train.compute_ips : 801.31 img/s train.data_time : 0.00125 s train.compute_time : 0.36774 s
Experiment ended
read 128660 files from 100 directories
read 5000 files from 100 directories
